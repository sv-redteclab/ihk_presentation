<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <title>Sven Vaupel - RedTecLab GmbH - 18168</title>

    <link rel="stylesheet" href="css/reveal.css" />
    <link
      class="progress-bar-style"
      rel="stylesheet"
      href="css/reveal-progress-bar.css"
    />
    <link class="theme" rel="stylesheet" href="css/theme/white.css" />
    <link
      class="progress-bar-theme"
      rel="stylesheet"
      href="css/reveal-progress-bar-light.css"
    />
    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/zenburn.css" />
    <script>
      const loaders = []
      const eventHandlers = {
        fragmentHide: [],
        fragmentShow: [],
        slideChange: []
      }
      const agenda = [
        { id: 'einleitung', title: 'Einleitung' },
        { id: 'system', title: 'System' },
        { id: 'projekt', title: 'Projekt' },
        { id: 'entwurf', title: 'Entwurf' },
        // { id: 'komponenten', title: 'Komponenten' },
        { id: 'bereitstellung', title: 'Bereitstellung' },
        { id: 'resumee', title: 'Resümee' }
      ]
    </script>
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <section id="s1" class="layout-center" data-progress-bar-show="false">
          <h1 class="progress-bar-no-entry">Notepad-Service</h1>
          <h4 class="progress-bar-no-entry">ehem. Wishlist-Service</h4>
        </section>

        <section id="s2" class="layout-center" data-progress-bar-show="false">
          <h1 class="progress-bar-no-entry">AGENDA</h1>
          <ul style="list-style-type: none;">
            <li>Einleitung</li>
            <li>System</li>
            <li>Projekt</li>
            <li>Entwurf</li>
            <!-- <li> Komponenten </li> -->
            <li>Bereitstellung</li>
            <li>Resümee</li>
          </ul>
        </section>

        <section id="s3" class="grid-rows" data-progress-bar-id="einleitung">
          <h1 style="align-self: flex-start;">Die RTL</h1>
          <div style="align-self: stretch;  height: calc(100% - 0.5em);">
            <include src="./img/company.svg"></include>
          </div>
        </section>

        <section id="s4" class="grid-rows" data-progress-bar-id="einleitung">
          <h1 style="align-self: flex-start;">Merkzettel</h1>
          <div style="align-self: stretch; height: calc(100% - 0.5em);">
            <include src="./mastercss/notepad.css"></include>
            <include src="./img/notepad.svg"></include>
          </div>
        </section>

        <section id="s5" class="grid-rows" data-progress-bar-id="system">
          <h1 style="align-self: flex-start;">Systemumgebung</h1>
          <!-- TODO SVG viewbox -->
          <div style="align-self: stretch; height: calc(100% - 0.5em);;">
            <include src="./mastercss/new_architecture.css"></include>
            <include src="./img/new_architecture.svg"></include>
          </div>
        </section>

        <section id="s6" class="grid-rows" data-progress-bar-id="system">
          <h1 style="align-self: flex-start;">Systemkomponenten</h1>
          <div style="align-self: stretch; height: calc(100% - 0.5em);;">
            <include src="./mastercss/components_combined.css"></include>
            <include src="./img/components_combined.svg"></include>
          </div>
        </section>

        <section
          id="s7-1"
          class="layout-columns"
          data-progress-bar-id="projekt"
        >
          <h1>Projektimpulse</h1>
          <style>
            #s7-1 h1 {
              margin-bottom: 2%;
            }
            #s7-1 h4 {
              margin-bottom: 5%;
              text-align: left;
            }
            #s7-1 ul {
              margin-left: 0;
              padding: 0 !important;
              list-style-type: none;
            }
            #s7-1 li {
              margin: 0 !important;
              padding-left: 0.5em;
            }
            #s7-1 li:before {
              content: '•';
              float: left;
              margin-left: -0.5em;
            }
            #s7-1 ul ul {
              margin-left: -2%;
            }
            #s7-1 > div {
              height: 59vh;
            }
            #s7-1 .quality {
              overflow: hidden;
              word-wrap: normal;
            }
            #s7-1 .quality:not(.visible) {
              width: 0%;
            }
            #s7-1 .quality.visible {
              animation: ewidth 1s;
            }
            @keyframes ewidth {
              from {
                width: 0%;
              }
              to {
                width: 33.33%;
              }
            }
            #s7-1 .headings,
            #s7-1 .lists {
              display: flex;
              justify-content: space-around;
            }
            #s7-1 .headings > *,
            #s7-1 .lists > * {
              width: 33.33%;
            }
          </style>
          <div data-fragment-index="12">
            <div class="headings">
              <h4 class="fragment" data-fragment-index="2">Dokumente</h4>
              <h4 class="quality fragment" data-fragment-index="12">
                Qualität
              </h4>
              <h4 class="fragment" data-fragment-index="6">
                Koopertation
              </h4>
            </div>
            <div class="lists">
              <ul>
                <li class="fragment" data-fragment-index="3">Antrag</li>
                <li class="fragment" data-fragment-index="4">
                  IHK
                  <ul>
                    <li>PH + LH</li>
                    <li>QM-Plan</li>
                    <li>
                      Strukturplan <br />
                      ...
                    </li>
                  </ul>
                </li>
                <li class="fragment" data-fragment-index="5">Bericht</li>
              </ul>

              <ul class="quality fragment" data-fragment-index="12">
                <li class="fragment" data-fragment-index="13">
                  Reviews
                </li>
                <li class="fragment" data-fragment-index="14">Testing</li>
                <li class="fragment" data-fragment-index="15">Automation</li>
              </ul>
              <ul class="fragment" data-fragment-index="7">
                <li>Agilität</li>
                <li class="fragment" data-fragment-index="9">
                  Funktions-übergreifend
                </li>
                <li class="fragment" data-fragment-index="10">Kommunikation</li>
              </ul>
            </div>
          </div>
        </section>

        <!-- <section id="s7-2" class="flex" data-progress-bar-id="1">
          <h1 style="align-self: flex-start;">Projektimpulse</h1>
        </section> -->

        <section id="s9" class="grid-rows" data-progress-bar-id="projekt">
          <h1 style="align-self: flex-start;">Planung</h1>
          <script>
            loaders.push(_ => {
              const ids = [
                'planung-borders',
                'planung-init',
                'planung-planung',
                'planung-entwurf',
                'planung-impl',
                'planung-abschluss'
              ]
              const isRight = id => ids.includes(id)
              const handleShow = event => {
                const fragment = event.fragment
                if (!isRight(fragment.id)) return
                if (fragment.id === 'planung-borders') {
                  Array.from(fragment.children)
                    .map(e => Array.from(e.children))
                    .flat()
                    .forEach((e, idx) => {
                      e.classList.add('visible')
                      let bb = e.getBBox()
                      let a = bb.x
                      let b = bb.y
                      e.animate(
                        [
                          {
                            opacity: 0
                          },
                          {
                            opacity: 0
                          }
                        ],
                        {
                          duration: 200 * idx
                        }
                      )
                      e.animate(
                        [
                          {
                            transform: `translate(0, -${b}px)`,
                            opacity: 0
                          },
                          {
                            transform: 'translate(0px, 0px)',
                            opacity: 1
                          }
                        ],
                        {
                          duration: 1000,
                          delay: 200 * idx
                        }
                      )
                    })

                  return
                }
                Array.from(fragment.children)
                  .reverse()
                  .forEach((e, idx) => {
                    e.classList.add('visible')
                    let bb = e.getBBox()
                    let a = bb.x
                    let b = bb.y
                    e.animate(
                      [
                        {
                          opacity: 0
                        },
                        {
                          opacity: 0
                        }
                      ],
                      {
                        duration: 200 * idx
                      }
                    )
                    e.animate(
                      [
                        {
                          transform: `translate(-${a}px, 0)`,
                          opacity: 0
                        },
                        {
                          transform: 'translate(0px, 0px)',
                          opacity: 1
                        }
                      ],
                      {
                        duration: 1000,
                        delay: 200 * idx
                      }
                    )
                  })
              }

              const handleHide = event => {
                const fragment = event.fragment
                if (!isRight(fragment.id)) return
                if (fragment.id === 'planung-borders') {
                  Array.from(fragment.children)
                    .map(e => Array.from(e.children))
                    .flat()
                    .forEach((e, idx) => {
                      e.classList.remove('visible')
                    })
                  return
                }
                for (const e of fragment.children) {
                  e.classList.remove('visible')
                }
              }
              eventHandlers.fragmentShow.push(handleShow)
              eventHandlers.fragmentHide.push(handleHide)

              eventHandlers.slideChange.push(event => {
                if (event.indexh !== 8 && event.indexh !== 6) return
                if (event.indexh === 8 && event.previousSlide.id === 's9') {
                  ids
                    .map(id => document.getElementById(id))
                    .map(fragment => ({ fragment }))
                    .forEach(handleShow)
                }
                if (event.indexh === 6 && event.previousSlide.id === 's9') {
                  ids
                    .map(id => document.getElementById(id))
                    .map(fragment => ({ fragment }))
                    .forEach(handleHide)
                }
              })
            })
          </script>
          <div style="align-self: stretch; height: calc(100% - 0.5em);">
            <include src="./mastercss/strukturplan_gesamt.css"></include>
            <include src="./img/strukturplan_gesamt.svg"></include>
          </div>
        </section>

        <section id="s11" class="grid-rows" data-progress-bar-id="entwurf">
          <style>
            #s11 #OpenAPI {
              display: grid;
              grid-template-columns: auto 1fr;
              grid-auto-flow: column;
              grid-gap: 0.5em;
            }
            /* #s11 #OpenAPI.visible:not(.current-fragment) {
              display: none;
            } */
            #s11 #OpenAPI.visible,
            #s11 .no-display.visible {
              animation: noDisplay 1s;
              height: 0;
              opacity: 0;
              padding: 0;
            }
            @keyframes noDisplay {
              from {
                opacity: 1;
                height: 100%;
              }
              to {
                opacity: 0;
                height: 0px;
                padding: 0;
              }
            }
            #s11 ul > li {
              opacity: 0;
            }
            #s11 ul > li.visible {
              opacity: 1;
              animation-name: smooth-fade-in, waiting;
            }
            #s11 ul > li:nth-child(1) {
              animation-duration: 1s, 1s;
              animation-delay: 1s, 0s;
            }
            #s11 ul > li:nth-child(2) {
              animation-duration: 1s, 2s;
              animation-delay: 2s, 0s;
            }
            #s11 ul > li:nth-child(3) {
              animation-duration: 1s, 3s;
              animation-delay: 3s, 0s;
            }
          </style>
          <script>
            loaders.push(_ => {
              const scrollIfId = (eId, id, value) => {
                if (eId === id) {
                  document.getElementById('DIV_1').scrollBy({
                    top: value,
                    left: 0,
                    behavior: 'smooth'
                  })
                }
              }
              const handle = sign => event => {
                scrollIfId(event.fragment.id, 'DIV_48', sign * (50 + 293))
                scrollIfId(event.fragment.id, 'DIV_76', sign * (50 + 141 + 40))
                scrollIfId(
                  event.fragment.id,
                  'TR_150',
                  sign * (50 + 20 + 40 + 319)
                )
                if (
                  event.fragments[1] &&
                  event.fragments[1].id === 'DIV_240' &&
                  true
                  // sign === -1
                ) {
                  document.getElementById('DIV_1').scrollTo(0, 0)
                }
              }
              eventHandlers.fragmentShow.push(handle(1))
              eventHandlers.fragmentHide.push(handle(-1))

              eventHandlers.slideChange.push(event => {
                if (event.indexh !== 9 && event.indexh !== 7) return
                if (event.indexh === 9 && event.previousSlide.id === 's11') {
                  document.getElementById('DIV_1').scrollTo(0, 1003)
                }
                if (event.indexh === 7 && event.previousSlide.id === 's11') {
                  document.getElementById('DIV_1').scrollTo(0, 0)
                }
              })
            })
          </script>
          <h1 style="align-self: flex-start;">Schnittstelle</h1>
          <div
            style="align-self: stretch; overflow: hidden; height: calc(100% - 0.5em);"
          >
            <div
              style="
            height: 100px;
            width: 100%;
            position: absolute;
            background: linear-gradient(0deg, white, transparent);
            bottom: 0.5em;
            z-index: 2000;
            "
            ></div>
            <div
              id="OpenAPI"
              class="fragment always-visible"
              data-fragment-index="2"
            >
              <div class="fragment" data-fragment-index="1">OpenAPI</div>
              <ul class="fragment" data-fragment-index="1">
                <li class="fragment" data-fragment-index="1">
                  Standard
                </li>
                <li class="fragment" data-fragment-index="1">
                  JSON/YML For mat &rArr; Maschinenlesbar
                </li>
                <li class="fragment" data-fragment-index="1">
                  Objektbeschr eibung als JSON-Schema
                </li>
              </ul>
            </div>
            <include src="./mastercss/swagger_snippet.css"></include>
            <include src="./img/swagger_snippet.html"></include>
          </div>
        </section>

        <section
          id="s12"
          class="grid-rows"
          style="grid-template-rows: min-content min-content auto;"
          data-progress-bar-id="entwurf"
        >
          <script>
            loaders.push(_ => {
              const idMap = {
                'service-providedInterface': 1,
                'service-router': 1,
                's11-1': 1,
                'service-middleware': 2,
                's11-2': 2,
                'service-adapter': 3,
                's11-3': 3,
                'service-usedInterface': 4,
                'service-connector': 4,
                'service-node': 5
              }
              const ids = Object.keys(idMap)

              const isRight = id => ids.includes(id)

              const transitions = [
                'scale(1)',
                'translate(500px, 0) scale(1.5)',
                'translate(170px, 0) scale(1.5)',
                'translate(-50px, 0) scale(1.5)',
                'translate(-250px, 0) scale(1.5)',
                'scale(1)'
              ]
              const toBlock = transform => ({ transform })
              const handle = type => event => {
                if (!isRight(event.fragment.id)) return
                const svg = document.getElementById('service')
                let idx = idMap[event.fragment.id]
                let from =
                  type === 'show' ? { transform: transitions[idx - 1] } : {}
                let to = type === 'show' ? { transform: transitions[idx] } : {}
                svg.animate([from, to], 1000)
                svg.style.transform = transitions[idx]
              }

              eventHandlers.fragmentShow.push(handle('show'))
              eventHandlers.fragmentHide.push(handle('hide'))

              eventHandlers.slideChange.push(event => {
                if (event.indexh !== 10 && event.indexh !== 8) return
                console.log(11111)
                if (event.indexh === 10 && event.previousSlide.id === 's12') {
                  ids
                    .map(id => document.getElementById(id))
                    .map(fragment => ({ fragment }))
                    .forEach(handle('show'))
                }
                if (event.indexh === 8 && event.previousSlide.id === 's12') {
                  ids
                    .map(id => document.getElementById(id))
                    .map(fragment => ({ fragment }))
                    .forEach(handle('hide'))
                }
              })
            })
          </script>
          <h1 style="align-self: flex-start;">Komponenten</h1>
          <style>
            #s12 ul li.visible span:nth-of-type(1) {
              animation: smooth-fade-in, s12-slide-in, waiting;
              animation-duration: 0.5s, 0.5s, 1s;
              animation-delay: 1s, 1s, 0s;
              display: inline-block;
            }
            #s12 ul li.visible span:nth-of-type(2) {
              animation: smooth-fade-in, s12-slide-in, waiting;
              animation-duration: 0.5s, 0.5s, 1.5s;
              animation-delay: 1.5s, 1.5s, 0s;
              display: inline-block;
            }

            @keyframes s12-slide-in {
              from {
                transform: translate(-50px, 0);
              }
              to {
                transform: translate(0, 0);
              }
            }
          </style>
          <ul style="margin-bottom: 0.3em; font-size: 0.9em;">
            <li id="s11-1" class="fragment" data-fragment-index="1">
              Orientierung an Koa
            </li>
            <li id="s11-2" class="fragment" data-fragment-index="6">
              Koa Middleware als Eventhandle<br />
              <span>&rArr; Reichern HTTP context an</span> <br />
              <span>&rArr; Entscheiden über weitergabe</span>
            </li>
            <li id="s11-3" class="fragment" data-fragment-index="7">
              Trennung von DB-Zugriff un -Verbindung
            </li>
          </ul>
          <div
            style="
            align-self: stretch;
            overflow: hidden;
            height: calc(100% - 0.5em);
          "
          >
            <include src="./mastercss/service_komponenten.css"></include>
            <include src="./img/service_komponenten.svg"></include>
          </div>
        </section>

        <section id="s13" class="grid-rows" data-progress-bar-id="entwurf">
          <script>
            loaders.push(_ => {
              const ids = [
                'mvc-middleware',
                'mvc-lifelines',
                'mvc-request-in',
                'mvc-auth',
                'mvc-validation',
                'mvc-entries-in',
                'mvc-adapter-in',
                'mvc-connector-in',
                'mvc-db-request',
                'mvc-connector-out',
                'mvc-adapter-out',
                'mvc-set-status',
                'mvc-entries-out',
                'mvc-break-box',
                'mvc-error',
                'mvc-response-out'
              ]
              const getFIdx = f => Number(f.getAttribute('data-fragment-index'))
              const isRight = id => ids.includes(id)

              const transitions = [
                [1, 0, 0],
                [2.5, 150, 180],
                [2.5, 150, 180],
                [2.5, 150, 180],
                [2.5, 115, 150],
                [2.5, -20, 110],
                [2.5, -110, 110],
                [2.5, -170, 110],
                [2.5, -170, 50],
                [2.5, -170, 50],
                [2.5, -170, -60],

                [1, 0, 0]
              ].map(([s, x, y]) => `scale(${s}) translate(${x}px, ${y}px)`)

              const boxesTransitions = [
                0,
                0,
                0,
                0,
                0,
                50,
                50,
                50,
                130,
                130,
                277,
                0
              ].map(y => `translate(0px, ${y}px)`)

              const toTransform = transform => ({ transform })
              let boxes
              let boxesBg
              let svg

              const handle = type => event => {
                if (!isRight(event.fragment.id)) return
                boxesBg = boxesBg || document.getElementById('mvc-boxes-bg')
                boxes = boxes || document.getElementById('mvc-boxes')
                svg = svg || document.getElementById('mvc')

                const f = event.fragment
                const id = f.id
                const idx = getFIdx(f)

                if (idx === 4 || (idx === 10 && type === 'hide')) {
                  boxesBg.setAttribute('fill', 'white')
                }
                if (idx === 3 || (idx === 10 && type === 'show')) {
                  boxesBg.setAttribute('fill', 'none')
                }

                if (type === 'show') {
                  let svgKeyframes = [transitions[idx], transitions[idx + 1]]
                  let boxKeyframes = [
                    boxesTransitions[idx],
                    boxesTransitions[idx + 1]
                  ]
                  if (![1, 2].includes(idx)) {
                    svg.animate(svgKeyframes.map(toTransform), 1000)
                    boxes.animate(boxKeyframes.map(toTransform), 1000)
                  }
                  svg.style.transform = transitions[idx + 1]
                  boxes.style.transform = boxesTransitions[idx + 1]
                }

                if (type === 'hide') {
                  svg.style.transform = transitions[idx]
                  boxes.style.transform = boxesTransitions[idx]
                }
              }

              eventHandlers.fragmentShow.push(handle('show'))
              eventHandlers.fragmentHide.push(handle('hide'))

              eventHandlers.slideChange.push(event => {
                if (event.indexh !== 11 && event.indexh !== 9) return
                if (event.indexh === 11 && event.previousSlide.id === 's13') {
                  ids
                    .map(id => document.getElementById(id))
                    .map(fragment => ({ fragment }))
                    .forEach(handle('show'))
                }
                if (event.indexh === 9 && event.previousSlide.id === 's13') {
                  ids
                    .map(id => document.getElementById(id))
                    .map(fragment => ({ fragment }))
                    .forEach(handle('hide'))
                }
              })
            })
          </script>
          <h1 style="align-self: flex-start;">Kontrollfluss</h1>
          <div
            style="align-self: stretch; overflow: hidden; height: calc(100% - 0.5em);"
          >
            <include src="./mastercss/service_request.css"></include>
            <include src="./img/service_request.svg"></include>
          </div>
        </section>

        <section
          id="s14"
          class="grid-rows"
          data-progress-bar-id="bereitstellung"
        >
          <script>
            loaders.push(_ => {
              const getFIdx = f => Number(f.getAttribute('data-fragment-index'))
              const isRight = id => id.includes('depl-')
              let svg
              const waiting = (e, t = 800, d = 0) => {
                e.animate([{ opacity: 0 }, { opacity: 0 }], {
                  duration: t,
                  delay: d
                })
              }
              const show = (e, t = 800, d = 0) => {
                e.animate([{ opacity: 0 }, { opacity: 1 }], {
                  duration: t,
                  delay: d
                })
                e.style.opacity = 1
              }
              const hide = (e, t = 800, d = 0) => {
                e.animate([{ opacity: 1 }, { opacity: 0 }], {
                  duration: t,
                  delay: d
                })
                e.style.opacity = 0
              }
              const toTransform = transform => ({ transform })

              const transitions = {
                0: {
                  show: () => {},
                  hide: () => {}
                },
                1: {
                  show: () => {
                    ;[
                      'depl-test-upper-box',
                      'depl-h-arrow-3',
                      'depl-deploy-box'
                    ]
                      .map(id => document.getElementById(id))
                      .forEach(e => hide(e))
                    svg.animate(
                      ['translate(60%, 0) scale(2)', 'scale(1)'].map(
                        toTransform
                      ),
                      1000
                    )
                    svg.style.transform = 'scale(1)'
                  },
                  hide: () => {
                    ;[
                      'depl-test-upper-box',
                      'depl-h-arrow-3',
                      'depl-deploy-box'
                    ]
                      .map(id => document.getElementById(id))
                      .forEach(e => show(e))
                    svg.style.transform = 'translate(60%, 0) scale(2)'
                  }
                },
                2: {
                  show: () => {
                    ;['depl-unit-validation', 'depl-unit-auth', 'depl-unit-dot']
                      .map(id => document.getElementById(id))
                      .forEach(e => {
                        waiting(e, 800)
                        show(e, 1000, 800)
                        e.animate(
                          ['translate(-30px, 0px)', 'translate(0px, 0px)'].map(
                            toTransform
                          ),
                          {
                            duration: 800,
                            delay: 800
                          }
                        )
                      })

                    const jest = document.getElementById('depl-unit-jest')
                    waiting(jest, 800)
                    show(jest, 1000, 800)
                    jest.animate(
                      ['translate(30px, 0px)', 'translate(0px, 0px)'].map(
                        toTransform
                      ),
                      {
                        duration: 800,
                        delay: 800
                      }
                    )

                    svg.animate(
                      ['scale(1)', 'translate(190px, 300px) scale(2)'].map(
                        toTransform
                      ),
                      1000
                    )
                    svg.style.transform = 'translate(190px, 300px) scale(2)'
                  },
                  hide: () => {
                    svg.style.transform = 'scale(1)'
                  }
                },
                3: {
                  show: () => {
                    const outer = document.getElementById('depl-unit-outer')
                    outer.animate(
                      [
                        {
                          transform: 'scale(1.1)',
                          transformOrigin: '737px 260px'
                        },
                        {
                          transform: 'scale(1)',
                          transformOrigin: '737px 260px'
                        }
                      ],
                      800
                    )
                  },
                  hide: () => {}
                },
                4: {
                  show: () => {
                    const outer = document.getElementById('depl-release-outer')
                    waiting(outer, 1800)
                    show(outer, 1000, 1800)
                    outer.animate(
                      [
                        {
                          transform: 'scale(1.1)',
                          transformOrigin: '694.5px 420px'
                        },
                        {
                          transform: 'scale(1)',
                          transformOrigin: '694.5px 420px'
                        }
                      ],
                      {
                        duration: 800,
                        delay: 1800
                      }
                    )

                    svg.animate(
                      [
                        'translate(190px, 300px) scale(2)',
                        'translate(190px, 0px) scale(2)'
                      ].map(toTransform),
                      1000
                    )
                    svg.style.transform = 'translate(190px, 0px) scale(2)'
                  },
                  hide: () => {
                    svg.style.transform = 'translate(190px, 300px) scale(2)'
                  }
                },
                5: {
                  show: () => {
                    const jest = document.getElementById('depl-int-jest')
                    const release = document.getElementById('depl-int-release')
                    const mongo = document.getElementById('depl-int-mongo')

                    waiting(release, 1000)
                    show(release, 800, 1000)
                    waiting(mongo, 1800)
                    show(mongo, 800, 1400)
                    waiting(jest, 1800)
                    show(jest, 800, 1800)

                    mongo.animate(
                      ['translate(30px, 0px)', 'translate(0px, 0px)'].map(
                        toTransform
                      ),
                      { duration: 800, delay: 1400 }
                    )

                    jest.animate(
                      ['translate(-30px, 0px)', 'translate(0px, 0px)'].map(
                        toTransform
                      ),
                      { duration: 800, delay: 1800 }
                    )

                    const releaseDocker = document.getElementById(
                      'depl-release'
                    )
                    releaseDocker.animate(
                      [
                        {
                          transform: 'scale(1)',
                          transformOrigin: '770px 720px'
                        },
                        {
                          transform: 'scale(0)',
                          transformOrigin: '770px 720px'
                        }
                      ],
                      {
                        duration: 1000,
                        delay: 200,
                        easing: 'cubic-bezier(0.6,0,1,1)'
                      }
                    )
                    releaseDocker.animate([{ opacity: 1 }, { opacity: 0 }], {
                      duration: 500,
                      delay: 700
                    })
                    waiting(releaseDocker, 2500, 1000)
                    releaseDocker.animate([{ opacity: 0 }, { opacity: 1 }], {
                      duration: 1200,
                      delay: 3500,
                      ease: 'cubic-bezier(0.9,0,1,1)'
                    })

                    svg.animate(
                      [
                        'translate(190px, 0px) scale(2)',
                        'translate(190px, -300px) scale(2)'
                      ].map(toTransform),
                      1000
                    )
                    svg.style.transform = 'translate(190px, -300px) scale(2)'
                  },
                  hide: () => {
                    svg.style.transform = 'translate(190px, 0px) scale(2)'
                  }
                },
                6: {
                  show: () => {
                    const outer = document.getElementById('depl-int-outer')
                    outer.animate(
                      [
                        {
                          transform: 'scale(1.1)',
                          transformOrigin: '770px 720px'
                        },
                        {
                          transform: 'scale(1)',
                          transformOrigin: '770px 720px'
                        }
                      ],
                      800
                    )
                  },
                  hide: () => {}
                },
                7: {
                  show: () => {
                    const upper = document.getElementById('depl-test-upper-box')
                    waiting(upper, 1000)
                    show(upper, 800, 1000)

                    const test = document.getElementById('depl-test')
                    waiting(test, 1000)
                    show(test, 800, 1000)

                    svg.animate(
                      ['translate(190px, -300px) scale(2)', 'scale(1)'].map(
                        toTransform
                      ),
                      1000
                    )
                    svg.style.transform = 'scale(1)'
                  },
                  hide: () => {
                    const upper = document.getElementById('depl-test-upper-box')
                    hide(upper)

                    const test = document.getElementById('depl-test')
                    hide(test)

                    svg.style.transform = 'translate(190px, -300px) scale(2)'
                  }
                },
                8: {
                  show: () => {
                    const box = document.getElementById('depl-deploy-box')
                    show(box)
                  },
                  hide: () => {
                    const box = document.getElementById('depl-deploy-box')
                    hide(box)
                  }
                },
                9: {
                  show: () => {
                    const release = document.getElementById('depl-release')
                    release.animate(
                      [
                        {
                          transform: 'translate(0px, 0px)',
                          animationTimingFunction: 'ease-in'
                        },
                        {
                          transform: 'translate(700px, 0px)',
                          animationTimingFunction: 'ease-in'
                        }
                      ],
                      {
                        duration: 1000,
                        delay: 1000,
                        easing: 'cubic-bezier(0.6,0,1,1)'
                      }
                    )
                    release.animate([{ opacity: 1 }, { opacity: 0 }], {
                      duration: 500,
                      delay: 1500
                    })

                    const arrow = document.getElementById('depl-h-arrow-3')
                    show(arrow)
                  },
                  hide: () => {
                    const arrow = document.getElementById('depl-h-arrow-3')
                    hide(arrow)
                  }
                }
              }

              const handle = type => event => {
                if (!isRight(event.fragment.id)) return
                svg = svg || document.getElementById('depl')
                const f = event.fragment
                const id = f.id
                const idx = getFIdx(f)
                transitions[idx][type]()
                if (idx === 0) svg.classList.add('zero')
                if (idx === 1) svg.classList.remove('zero')
                return
              }

              eventHandlers.fragmentShow.push(handle('show'))
              eventHandlers.fragmentHide.push(handle('hide'))

              eventHandlers.slideChange.push(event => {
                if (event.indexh !== 12 && event.indexh !== 10) return
                if (event.indexh === 12 && event.previousSlide.id === 's14') {
                  Object.keys(transitions)
                    .map(k => ({ id: 'depl-', getAttribute: () => k }))
                    .map(fragment => ({ fragment }))
                    .forEach(handle('show'))
                }
                if (event.indexh === 10 && event.previousSlide.id === 's14') {
                  Object.keys(transitions)
                    .map(k => ({ id: 'depl-', getAttribute: () => k }))
                    .map(fragment => ({ fragment }))
                    .reverse()
                    .forEach(handle('hide'))
                }
              })
            })
          </script>
          <h1 style="align-self: flex-start;">Bereitstellung</h1>
          <div
            style="align-self: stretch; overflow:hidden; : calc(100% - 0.5em);"
          >
            <include src="./mastercss/deployment_h.css"></include>
            <include src="./img/deployment_h.svg"></include>
          </div>
        </section>

        <section id="s15" class="flex" data-progress-bar-id="resumee">
          <h1 style="align-self: flex-start; margin-bottom: 1em;">Resümee</h1>
          <div
            style="
            align-self: center;
            display: grid;
            grid-template-rows: 1fr 1fr 1em 1fr 1fr;
            grid-template-columns: auto 1fr;
            grid-column-gap: 1em;
          "
          >
            <div
              class="fragment"
              data-fragment-index="1"
              style="justify-self: end; font-weight: bold; color: #f00000;"
            >
              &CircleMinus;
            </div>
            <div class="fragment" data-fragment-index="1">Dokumente</div>
            <div
              class="fragment"
              data-fragment-index="2"
              style="justify-self: end; font-weight: bold; color: green;"
            >
              &CirclePlus;
            </div>
            <div class="fragment" data-fragment-index="2">
              Volle Projektbegleitung
            </div>

            <div></div>
            <div></div>

            <div
              class="fragment"
              data-fragment-index="3"
              style="justify-self: end; font-weight: bold;"
            >
              Lessons:
            </div>
            <div class="fragment" data-fragment-index="3">Kiss + MVP</div>
            <div
              class="fragment"
              data-fragment-index="4"
              style="justify-self: end; font-weight: bold;"
            >
              Hopes:
            </div>
            <div class="fragment" data-fragment-index="4">
              Feegback für andere Azubis
            </div>
          </div>
        </section>

        <script>
          document.querySelectorAll('.slides section:not(#s11)')
          // .forEach(e => (e.outerHTML = ''))
          window.setTimeout(_ => {
            for (let i = 0; i < 20; i++) {
              // Reveal.nextFragment()
            }
          }, 1000)
        </script>
      </div>
    </div>

    <script src="js/reveal.js"></script>

    <script>
      // replace include tags
      for (let e of document.getElementsByTagName('include')) {
        let src = e.getAttribute('src')
        fetch(src)
          .then(r => r.text())
          .then(html => {
            e.outerHTML = /.css$/.test(src) ? `<style>${html}</style>` : html
          })
      }

      // Insert spans for lowercase substrings into h tags
      document.querySelectorAll('h1,h2,h3,h4,h5,h6').forEach(e => {
        const open = '<span>'
        const close = '</span>'
        let wasLower = false
        let current = ''

        for (let l of e.innerText)
          if (/[a-zäüö]/.test(l)) {
            current += wasLower ? l : open + l
            wasLower = true
          } else {
            current += wasLower ? close + l : l
            wasLower = false
          }

        e.innerHTML = current
      })
      // More info about config & dependencies:
      // - https://github.com/hakimel/reveal.js#configuration
      // - https://github.com/hakimel/reveal.js#dependencies
      window.onload = _ => {
        loaders.forEach(l => l())

        Reveal.initialize({
          controls: false,
          slideNumber: true,
          // overview: false,
          progress: false,
          center: false,
          dependencies: [
            { src: 'plugin/markdown/marked.js' },
            { src: 'plugin/markdown/markdown.js' },
            { src: 'plugin/notes/notes.js', async: true },
            {
              src: 'plugin/highlight/highlight.js',
              async: true,
              callback: function() {
                hljs.initHighlightingOnLoad()
              }
            },
            //{ src: 'plugin/reveal-agenda/reveal-agenda.js', async: true, callback: function() { reveal_agenda.initialize({ agenda, insertToPosition: 1 }); } },
            {
              src: 'plugin/reveal-progress-bar/reveal-progress-bar.js',
              async: true,
              callback: function() {
                reveal_progress_bar.initialize({ agenda })
              }
            }
          ]
        })

        Reveal.configure({
          keyboard: {
            /* P */ 80: () => {
              document
                .querySelector('.reveal .slides')
                .setAttribute('style', '')
              print()
            }
          }
        })

        eventHandlers.fragmentShow.forEach(handler =>
          Reveal.addEventListener('fragmentshown', handler)
        )

        eventHandlers.fragmentHide.forEach(handler =>
          Reveal.addEventListener('fragmenthidden', handler)
        )

        eventHandlers.slideChange.forEach(handler =>
          Reveal.addEventListener('slidechanged', handler)
        )

        Reveal.addEventListener('slidechanged', event => {
          console.log(event)
          console.log(Reveal.getIndices())
        })

        Reveal.addEventListener('fragmentshown', function(event) {
          console.log(event)
        })
        Reveal.addEventListener('fragmenthidden', function(event) {
          console.log(event)
          // event.fragment = the fragment DOM element
        })
      }
    </script>

    <link rel="stylesheet" href="./mastercss/master.css" />
    <link rel="stylesheet" href="./css/reveal-progress-bar.css" />
  </body>
</html>
